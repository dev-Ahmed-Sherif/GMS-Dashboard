<div class="container-fluid page">
  <div class="d-flex page__box p-3 mt-2">Orders</div>
  <div class="page__content shadow p-3 position-relative">
    <div class="page__content-data position-absolute text-center">
      
      <div class="mat-elevation-z8" style="margin-top: 10px">
        <table
          mat-table
          [dataSource]="dataSource"
          matSort
          style="width: 100%; text-align: center"
        >
          <!-- Product Name Column -->
          <ng-container matColumnDef="orderId">
            <th
              mat-header-cell
              *matHeaderCellDef
              mat-sort-header
              style="
                display: flex;
                justify-content: center;
                align-items: center;
                height: inherit;
              "
            >
              Order ID
            </th>
            <td mat-cell *matCellDef="let row">{{ row._id }}</td>
          </ng-container>

          <!-- Product discription Column -->
          <ng-container matColumnDef="email">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              User Email
            </th>
            <td mat-cell *matCellDef="let row">{{ row.email }}</td>
          </ng-container>

          <!---- Product image column ---->
          <ng-container matColumnDef="items">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              Order Data
            </th>
            <!-- <td mat-cell *matCellDef="let row">
              <span *ngFor="let item of row.items; let i = index"
                >{{ i + 1 }} - item with price {{ item.price }}
                <br />
              </span>
            </td> -->
            <td mat-cell *matCellDef="let row">
              <button
                type="button"
                class="btn my-2"
                style="background-color: #ff5733"
                data-bs-toggle="modal"
                data-bs-target="#staticBackdrop"
                (click)="changeItems(row.items)"
              >
                Order Details
              </button>

              <div
                class="modal fade"
                id="staticBackdrop"
                data-bs-backdrop="static"
                data-bs-keyboard="false"
                tabindex="-1"
                aria-labelledby="staticBackdropLabel"
                aria-hidden="true"
              >
                <div class="modal-dialog">
                  <div class="modal-content bg-white">
                    <div class="modal-header">
                      <h5 class="modal-title" id="staticBackdropLabel">
                        Order Components
                      </h5>
                      <button
                        type="button"
                        class="btn-close"
                        data-bs-dismiss="modal"
                        aria-label="Close"
                      ></button>
                    </div>
                    <div class="modal-body">
                      <span *ngFor="let item of items; let i = index"
                        >{{ i + 1 }} - {{ item.title }} with price
                        {{ item.price }}
                        <br />
                      </span>
                    </div>
                    <div class="modal-footer">
                      <button
                        type="button"
                        class="btn btn-secondary "
                        data-bs-dismiss="modal"
                      >
                        Close
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </td>
          </ng-container>

          <!---- Price column ---->
          <ng-container matColumnDef="TotalPrice">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              Total Price
            </th>
            <td mat-cell *matCellDef="let cell">
              <h3>
                {{ getTotal(cell) }} EGP
              </h3>
            </td>
          </ng-container>

          <!-----Action Column ---->
          <ng-container matColumnDef="action">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Action</th>

            <td mat-cell *matCellDef="let row"></td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>

          <!-- Row shown when there is no matching data. -->
          <!-- <tr class="mat-row" *matNoDataRow>
              <td class="mat-cell" colspan="4">
                No data matching the filter "{{ input.value }}"
              </td>
            </tr> -->
        </table>

        <mat-paginator
          [pageSizeOptions]="[5, 10, 25, 100]"
          aria-label="Select page of users"
        ></mat-paginator>
      </div>
    </div>
  </div>
</div>
